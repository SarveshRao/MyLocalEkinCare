%tr.immunization-row
  %td
    = @immunization.name
  %td
    = @immunization.immunization_type
  %td
    = formatted_dates(@immunization.customer_immunizations.map(&:date)).join(' ') rescue ''
  %td
    = @immunization.customer_immunizations.map(&:dosage).join(' ')
  %td
    = @immunization.customer_immunizations.map(&:instructions).join(' ')
  %td
    %a.pull-right.dropdown-toggle.customer-immunization-edit-pencil{"data-toggle" => "dropdown", href: "#"}
      %i.fa.fa-pencil
  %td
    %a.pull-right.dropdown-toggle.customer-immunization-delete-row{"data-toggle" => "dropdown", href: "#"}
      %i.i.i-trashcan

%tr.edit_immunization_row.hide{customer_id: @customer.id, immunization_id: @immunization.id}
  = form_for @immunization, url: customers_immunization_path(@immunization), html: {class: 'edit-customer-immunization'}, remote: true do |f|
    %td
      = f.text_area :name, {class: 'form-control'}
    %td
      = f.text_area :immunization_type, {class: 'form-control'}
    %td
      = f.fields_for :customer_immunizations, @customer.customer_immunizations.find_by(immunization_id: @immunization.id) do |ci|
        = ci.text_field :date, {value: numeric_date_format(@customer.customer_immunizations.find_by(immunization_id: @immunization.id).date), class: 'form-control datepicker datepicker-input', 'data-date-format' => 'dd-mm-yyyy', placeholder: 'dd-mm-yyyy'}
    %td
      = f.fields_for :customer_immunizations, @customer.customer_immunizations.find_by(immunization_id: @immunization.id) do |ci|
        = ci.text_field :dosage, {class: 'form-control'}
    %td
      = f.fields_for :customer_immunizations, @customer.customer_immunizations.find_by(immunization_id: @immunization.id) do |ci|
        = ci.text_area :instructions, {class: 'form-control'}
    %td
      = f.submit 'save', {class:'btn btn-sm small-btn btn-primary customer-immunization-save-btn'}
    %td
      %a{class: 'btn btn-sm small-btn btn-danger customer-immunization-cancel-btn'} cancel
      %input{type: 'reset', class: 'hide reset-customer-immunization-btn'}
